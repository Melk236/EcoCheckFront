<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-[2px] p-4">
  <div class="w-full max-w-md transform overflow-hidden rounded-xl bg-white dark:bg-gray-700 p-8 text-center shadow-2xl transition-all border border-gray-200 dark:border-gray-600">
    <h3 class="text-2xl font-bold leading-tight text-gray-800 dark:text-white mb-3">
      Cambiar contraseña
    </h3>
    <p class="text-gray-600 dark:text-gray-400 text-base leading-relaxed mb-6 px-2">
      Ingresa tu nueva contraseña. Debe tener al menos 6 caracteres.
    </p>

    <form class="flex flex-col gap-4 mb-6" [formGroup]="formulario">
      <div class="flex flex-col gap-1.5">
        <input type="password" formControlName="currentPassword" placeholder="Contraseña actual"
          class="w-full rounded-lg px-4 py-3 text-gray-800 dark:text-white bg-gray-50 dark:bg-gray-600 border border-gray-200 dark:border-gray-500 focus:outline-none focus:ring-2 focus:ring-green-500/50"
          [class.border-red-500]="formulario.get('currentPassword')?.invalid && formulario.get('currentPassword')?.touched" />
        @if(formulario.get('currentPassword')?.invalid && formulario.get('currentPassword')?.touched){
          <span class="text-red-500 text-xs text-left">La contraseña actual es obligatoria</span>
        }
      </div>
      
      <div class="flex flex-col gap-1.5">
        <input type="password" formControlName="password" placeholder="Nueva contraseña"
          class="w-full rounded-lg px-4 py-3 text-gray-800 dark:text-white bg-gray-50 dark:bg-gray-600 border border-gray-200 dark:border-gray-500 focus:outline-none focus:ring-2 focus:ring-green-500/50"
          [class.border-red-500]="formulario.get('password')?.invalid && formulario.get('password')?.touched" />
        @if(formulario.get('password')?.invalid && formulario.get('password')?.touched){
          <span class="text-red-500 text-xs text-left">
            @if(formulario.get('password')?.hasError('required')){La contraseña es obligatoria}
            @if(formulario.get('password')?.hasError('minlength')){Mínimo 6 caracteres}
            @if(formulario.get('password')?.hasError('maxlength')){Máximo 20 caracteres}
            @if(formulario.get('password')?.hasError('pattern')){Solo letras, números y guiones bajos}
          </span>
        }
      </div>
      
      <div class="flex flex-col gap-1.5">
        <input type="password" formControlName="confirmPassword" placeholder="Confirmar contraseña"
          class="w-full rounded-lg px-4 py-3 text-gray-800 dark:text-white bg-gray-50 dark:bg-gray-600 border border-gray-200 dark:border-gray-500 focus:outline-none focus:ring-2 focus:ring-green-500/50"
          [class.border-red-500]="formulario.get('confirmPassword')?.invalid && formulario.get('confirmPassword')?.touched" />
        @if(formulario.get('confirmPassword')?.invalid && formulario.get('confirmPassword')?.touched){
          <span class="text-red-500 text-xs text-left">
            @if(formulario.get('confirmPassword')?.hasError('required')){La confirmación es obligatoria}
            @if(formulario.get('confirmPassword')?.hasError('minlength')){Mínimo 6 caracteres}
          </span>
        }
        @if(formulario.get('confirmPassword')?.touched && formulario.get('password')?.value !== formulario.get('confirmPassword')?.value){
          <span class="text-red-500 text-xs text-left">Las contraseñas no coinciden</span>
        }
      </div>
    </form>
    
    <div class="flex flex-col sm:flex-row gap-3 w-full">
      <button (click)="onCancel()"
        class="flex-1 cursor-pointer rounded-lg min-h-10 text-gray-700 dark:text-gray-300 text-sm font-bold tracking-wide transition-all btn-hover"
        style="background-color: #f3f4f6;">
        Cancelar
      </button>
      <button (click)="onConfirm()"
        class="flex-1 rounded-lg min-h-10 text-sm font-bold tracking-wide transition-all shadow-lg btn-hover"
        [ngClass]="{
          'cursor-pointer bg-green-600 hover:bg-green-700 text-white': formulario.valid,
          'cursor-not-allowed bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400': formulario.invalid
        }"
        [disabled]="formulario.invalid">
        Cambiar
      </button>
    </div>
    
  </div>
</div>
